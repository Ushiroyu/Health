{
  "info": {
    "_postman_id": "2adf9c3e-eb3c-4a50-9fa3-f2b7f1a4babc",
    "name": "Community Health Platform",
    "description": "公共集合：通过 API 网关演示认证、档案、医生、预约、资讯、活动、文件等核心接口。先运行 Login 获取 bearer token，然后按顺序调用其他请求。",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Auth",
      "item": [
        {
          "name": "Login (set Bearer token)",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 200) {",
                  "  const json = pm.response.json();",
                  "  if (json.data && json.data.token) {",
                  "    pm.collectionVariables.set('authToken', json.data.token);",
                  "  }",
                  "  if (json.data && json.data.userId) {",
                  "    pm.collectionVariables.set('currentUserId', json.data.userId);",
                  "  }",
                  "}",
                  "pm.test('登录成功', function () {",
                  "  pm.response.to.have.status(200);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"admin\",\n  \"password\": \"admin123\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/auth/login",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "auth",
                "login"
              ]
            }
          }
        },
        {
          "name": "Register Resident",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"resident_demo\",\n  \"password\": \"demo1234\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/auth/register",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "auth",
                "register"
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Profiles",
      "item": [
        {
          "name": "Profile - Get Mine",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/user/profile/me",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "user",
                "profile",
                "me"
              ]
            }
          }
        },
        {
          "name": "Profile - Update Mine",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"fullName\": \"张三\",\n  \"gender\": \"MALE\",\n  \"birthDate\": \"1990-05-20\",\n  \"bloodType\": \"O\",\n  \"phone\": \"13000000000\",\n  \"email\": \"demo@health.local\",\n  \"address\": \"杭州市拱墅区 XX 路 88 号\",\n  \"chronicConditions\": \"高血压,糖尿病\",\n  \"allergies\": \"青霉素\",\n  \"medicalHistory\": \"2024 急性支气管炎\",\n  \"medications\": \"缬沙坦\",\n  \"emergencyContact\": \"李四\",\n  \"emergencyPhone\": \"13100000000\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/user/profile/me",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "user",
                "profile",
                "me"
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Doctors",
      "item": [
        {
          "name": "Doctor - Search",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/doctor/search?keyword=高血压&symptoms=高血压&date=2025-10-11",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "doctor",
                "search"
              ],
              "query": [
                {
                  "key": "keyword",
                  "value": "高血压"
                },
                {
                  "key": "symptoms",
                  "value": "高血压"
                },
                {
                  "key": "date",
                  "value": "2025-10-11"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Appointments",
      "item": [
        {
          "name": "Appointment - Query Slots",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/appointment/slots?doctorId=1&date=2025-10-11",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "appointment",
                "slots"
              ],
              "query": [
                {
                  "key": "doctorId",
                  "value": "1"
                },
                {
                  "key": "date",
                  "value": "2025-10-11"
                }
              ]
            }
          }
        },
        {
          "name": "Appointment - Book",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 200) {",
                  "  const json = pm.response.json();",
                  "  if (json.data && json.data.apptId) {",
                  "    pm.collectionVariables.set('appointmentId', json.data.apptId);",
                  "  }",
                  "}",
                  "pm.test('预约提交', function () {",
                  "  pm.response.to.have.status(200);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"doctorId\": 1,\n  \"date\": \"2025-10-11\",\n  \"time\": \"09:00-09:15\",\n  \"symptom\": \"持续头晕，怀疑高血压\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/appointment/book",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "appointment",
                "book"
              ]
            }
          }
        },
        {
          "name": "Appointment - My List",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/appointment/my?page=0&size=10",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "appointment",
                "my"
              ],
              "query": [
                {
                  "key": "page",
                  "value": "0"
                },
                {
                  "key": "size",
                  "value": "10"
                }
              ]
            }
          }
        },
        {
          "name": "Appointment - Cancel",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/appointment/cancel/{{appointmentId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "appointment",
                "cancel",
                "{{appointmentId}}"
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Content",
      "item": [
        {
          "name": "Article - Search",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/content/article/search?category=健康预防&page=0&size=5",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "content",
                "article",
                "search"
              ],
              "query": [
                {
                  "key": "category",
                  "value": "健康预防"
                },
                {
                  "key": "page",
                  "value": "0"
                },
                {
                  "key": "size",
                  "value": "5"
                }
              ]
            }
          }
        },
        {
          "name": "Article - Detail",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/content/article/1",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "content",
                "article",
                "1"
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Files",
      "item": [
        {
          "name": "File - Upload",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "file",
                  "type": "file",
                  "src": ""
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/file/upload",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "file",
                "upload"
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Activities",
      "item": [
        {
          "name": "Activity - Search",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/activity/event/search?page=0&size=5",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "activity",
                "event",
                "search"
              ],
              "query": [
                {
                  "key": "page",
                  "value": "0"
                },
                {
                  "key": "size",
                  "value": "5"
                }
              ]
            }
          }
        },
        {
          "name": "Activity - Register",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/activity/event/{{eventId}}/register",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "activity",
                "event",
                "{{eventId}}",
                "register"
              ]
            }
          }
        },
        {
          "name": "Activity - My Registrations",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/activity/my-registrations?page=0&size=10",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "activity",
                "my-registrations"
              ],
              "query": [
                {
                  "key": "page",
                  "value": "0"
                },
                {
                  "key": "size",
                  "value": "10"
                }
              ]
            }
          }
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8080"
    },
    {
      "key": "authToken",
      "value": ""
    },
    {
      "key": "appointmentId",
      "value": ""
    },
    {
      "key": "eventId",
      "value": "1"
    },
    {
      "key": "currentUserId",
      "value": ""
    }
  ]
}
