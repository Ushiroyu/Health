{
    "info":  {
                 "_postman_id":  "2adf9c3e-eb3c-4a50-9fa3-f2b7f1a4babc",
                 "name":  "Community Health Platform",
                 "description":  "公共集合：通过 API 网关演示认证、档案、医生、预约、资讯、活动、文件等核心接口。先运行 Login 获取 bearer token，然后按顺序调用其他请求。",
                 "schema":  "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
             },
    "item":  [
                 {
                     "name":  "Auth",
                     "item":  [
                                  {
                                      "name":  "Login (set Bearer token)",
                                      "event":  [
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "type":  "text/javascript",
                                                                       "exec":  [
                                                                                    "if (pm.response.code === 200) {",
                                                                                    "  const json = pm.response.json();",
                                                                                    "  if (json.data \u0026\u0026 json.data.token) {",
                                                                                    "    pm.collectionVariables.set(\u0027authToken\u0027, json.data.token);",
                                                                                    "  }",
                                                                                    "  if (json.data \u0026\u0026 json.data.userId) {",
                                                                                    "    pm.collectionVariables.set(\u0027currentUserId\u0027, json.data.userId);",
                                                                                    "  }",
                                                                                    "}",
                                                                                    "pm.test(\u0027登录成功\u0027, function () {",
                                                                                    "  pm.response.to.have.status(200);",
                                                                                    "});"
                                                                                ]
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\n  \"username\": \"admin\",\n  \"password\": \"admin123\"\n}",
                                                                   "options":  {
                                                                                   "raw":  {
                                                                                               "language":  "json"
                                                                                           }
                                                                               }
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/auth/login",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "auth",
                                                                               "login"
                                                                           ]
                                                              },
                                                      "description":  "调用 /auth/login 完成管理员/演示账号登录，并缓存 JWT 与 userId 供后续接口复用。"
                                                  }
                                  },
                                  {
                                      "name":  "Register Resident",
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\n  \"username\": \"resident_demo\",\n  \"password\": \"demo1234\"\n}",
                                                                   "options":  {
                                                                                   "raw":  {
                                                                                               "language":  "json"
                                                                                           }
                                                                               }
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/auth/register",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "auth",
                                                                               "register"
                                                                           ]
                                                              },
                                                      "description":  "通过 /auth/register 注册普通居民账号，模拟用户自助开户（管理员等高级角色仍需后台创建）。"
                                                  }
                                  }
                              ]
                 },
                 {
                     "name":  "Profiles",
                     "item":  [
                                  {
                                      "name":  "Profile - Get Mine",
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{authToken}}"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/user/profile/me",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "user",
                                                                               "profile",
                                                                               "me"
                                                                           ]
                                                              },
                                                      "description":  "GET /user/profile/me 获取当前登录人的健康档案，依赖 Login 步骤设置的 Bearer token。"
                                                  }
                                  },
                                  {
                                      "name":  "Profile - Update Mine",
                                      "request":  {
                                                      "method":  "PUT",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{authToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\n  \"fullName\": \"张三\",\n  \"gender\": \"MALE\",\n  \"birthDate\": \"1990-05-20\",\n  \"bloodType\": \"O\",\n  \"phone\": \"13000000000\",\n  \"email\": \"demo@health.local\",\n  \"address\": \"杭州市拱墅区 XX 路 88 号\",\n  \"chronicConditions\": \"高血压,糖尿病\",\n  \"allergies\": \"青霉素\",\n  \"medicalHistory\": \"2024 急性支气管炎\",\n  \"medications\": \"缬沙坦\",\n  \"emergencyContact\": \"李四\",\n  \"emergencyPhone\": \"13100000000\"\n}",
                                                                   "options":  {
                                                                                   "raw":  {
                                                                                               "language":  "json"
                                                                                           }
                                                                               }
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/user/profile/me",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "user",
                                                                               "profile",
                                                                               "me"
                                                                           ]
                                                              },
                                                      "description":  "PUT /user/profile/me 更新本人档案信息（基本信息、慢病、紧急联系人等字段）。"
                                                  }
                                  }
                              ]
                 },
                 {
                     "name":  "Doctors",
                     "item":  [
                                  {
                                      "name":  "Doctor - Search",
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{authToken}}"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/doctor/search?keyword=高血压\u0026symptoms=高血压\u0026date=2025-10-11",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "doctor",
                                                                               "search"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "keyword",
                                                                                    "value":  "高血压"
                                                                                },
                                                                                {
                                                                                    "key":  "symptoms",
                                                                                    "value":  "高血压"
                                                                                },
                                                                                {
                                                                                    "key":  "date",
                                                                                    "value":  "2025-10-11"
                                                                                }
                                                                            ]
                                                              },
                                                      "description":  "GET /doctor/search 按科室/关键字/症状及可选日期时段筛选医生与剩余号源情况。"
                                                  }
                                  }
                              ]
                 },
                 {
                     "name":  "Appointments",
                     "item":  [
                                  {
                                      "name":  "Appointment - Query Slots",
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{authToken}}"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/appointment/slots?doctorId=1\u0026date=2025-10-11",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "appointment",
                                                                               "slots"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "doctorId",
                                                                                    "value":  "1"
                                                                                },
                                                                                {
                                                                                    "key":  "date",
                                                                                    "value":  "2025-10-11"
                                                                                }
                                                                            ]
                                                              },
                                                      "description":  "GET /appointment/slots 查询指定医生在某天各时段的剩余名额，预订前可先查看容量。"
                                                  }
                                  },
                                  {
                                      "name":  "Appointment - Book",
                                      "event":  [
                                                    {
                                                        "listen":  "test",
                                                        "script":  {
                                                                       "type":  "text/javascript",
                                                                       "exec":  [
                                                                                    "if (pm.response.code === 200) {",
                                                                                    "  const json = pm.response.json();",
                                                                                    "  if (json.data \u0026\u0026 json.data.apptId) {",
                                                                                    "    pm.collectionVariables.set(\u0027appointmentId\u0027, json.data.apptId);",
                                                                                    "  }",
                                                                                    "}",
                                                                                    "pm.test(\u0027预约提交\u0027, function () {",
                                                                                    "  pm.response.to.have.status(200);",
                                                                                    "});"
                                                                                ]
                                                                   }
                                                    }
                                                ],
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{authToken}}"
                                                                     },
                                                                     {
                                                                         "key":  "Content-Type",
                                                                         "value":  "application/json"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "raw",
                                                                   "raw":  "{\n  \"doctorId\": 1,\n  \"date\": \"2025-10-11\",\n  \"time\": \"09:00-09:15\",\n  \"symptom\": \"持续头晕，怀疑高血压\"\n}",
                                                                   "options":  {
                                                                                   "raw":  {
                                                                                               "language":  "json"
                                                                                           }
                                                                               }
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/appointment/book",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "appointment",
                                                                               "book"
                                                                           ]
                                                              },
                                                      "description":  "POST /appointment/book 预约指定医生/日期/时段（Redis+Lua 做容量控制），成功后写入 appointmentId 变量。"
                                                  }
                                  },
                                  {
                                      "name":  "Appointment - My List",
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{authToken}}"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/appointment/my?page=0\u0026size=10",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "appointment",
                                                                               "my"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "page",
                                                                                    "value":  "0"
                                                                                },
                                                                                {
                                                                                    "key":  "size",
                                                                                    "value":  "10"
                                                                                }
                                                                            ]
                                                              },
                                                      "description":  "GET /appointment/my 查看当前账号的预约历史，可用 page/size/status 过滤。"
                                                  }
                                  },
                                  {
                                      "name":  "Appointment - Cancel",
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{authToken}}"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/appointment/cancel/{{appointmentId}}",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "appointment",
                                                                               "cancel",
                                                                               "{{appointmentId}}"
                                                                           ]
                                                              },
                                                      "description":  "POST /appointment/cancel/{id} 取消上一步获得的预约（仅限预约人自身）。"
                                                  }
                                  }
                              ]
                 },
                 {
                     "name":  "Content",
                     "item":  [
                                  {
                                      "name":  "Article - Search",
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{authToken}}"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/content/article/search?category=健康预防\u0026page=0\u0026size=5",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "content",
                                                                               "article",
                                                                               "search"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "category",
                                                                                    "value":  "健康预防"
                                                                                },
                                                                                {
                                                                                    "key":  "page",
                                                                                    "value":  "0"
                                                                                },
                                                                                {
                                                                                    "key":  "size",
                                                                                    "value":  "5"
                                                                                }
                                                                            ]
                                                              },
                                                      "description":  "GET /content/article/search 根据分类或关键字分页检索已发布的健康资讯。"
                                                  }
                                  },
                                  {
                                      "name":  "Article - Detail",
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{authToken}}"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/content/article/1",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "content",
                                                                               "article",
                                                                               "1"
                                                                           ]
                                                              },
                                                      "description":  "GET /content/article/{id} 按 ID 查看文章详情。"
                                                  }
                                  }
                              ]
                 },
                 {
                     "name":  "Files",
                     "item":  [
                                  {
                                      "name":  "File - Upload",
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{authToken}}"
                                                                     }
                                                                 ],
                                                      "body":  {
                                                                   "mode":  "formdata",
                                                                   "formdata":  [
                                                                                    {
                                                                                        "key":  "file",
                                                                                        "type":  "file",
                                                                                        "src":  ""
                                                                                    }
                                                                                ]
                                                               },
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/file/upload",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "file",
                                                                               "upload"
                                                                           ]
                                                              },
                                                      "description":  "POST /file/upload 以 multipart 上传图片/PDF 到 MinIO，并返回对象名与预签名 URL。"
                                                  }
                                  }
                              ]
                 },
                 {
                     "name":  "Activities",
                     "item":  [
                                  {
                                      "name":  "Activity - Search",
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{authToken}}"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/activity/event/search?page=0\u0026size=5",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "activity",
                                                                               "event",
                                                                               "search"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "page",
                                                                                    "value":  "0"
                                                                                },
                                                                                {
                                                                                    "key":  "size",
                                                                                    "value":  "5"
                                                                                }
                                                                            ]
                                                              },
                                                      "description":  "GET /activity/event/search 按关键字或时间范围查询社区活动列表。"
                                                  }
                                  },
                                  {
                                      "name":  "Activity - Register",
                                      "request":  {
                                                      "method":  "POST",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{authToken}}"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/activity/event/{{eventId}}/register",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "activity",
                                                                               "event",
                                                                               "{{eventId}}",
                                                                               "register"
                                                                           ]
                                                              },
                                                      "description":  "POST /activity/event/{id}/register 为 {{eventId}} 活动报名，并进行容量校验。"
                                                  }
                                  },
                                  {
                                      "name":  "Activity - My Registrations",
                                      "request":  {
                                                      "method":  "GET",
                                                      "header":  [
                                                                     {
                                                                         "key":  "Authorization",
                                                                         "value":  "Bearer {{authToken}}"
                                                                     }
                                                                 ],
                                                      "url":  {
                                                                  "raw":  "{{baseUrl}}/activity/my-registrations?page=0\u0026size=10",
                                                                  "host":  [
                                                                               "{{baseUrl}}"
                                                                           ],
                                                                  "path":  [
                                                                               "activity",
                                                                               "my-registrations"
                                                                           ],
                                                                  "query":  [
                                                                                {
                                                                                    "key":  "page",
                                                                                    "value":  "0"
                                                                                },
                                                                                {
                                                                                    "key":  "size",
                                                                                    "value":  "10"
                                                                                }
                                                                            ]
                                                              },
                                                      "description":  "GET /activity/my-registrations 查看当前账号的活动报名记录。"
                                                  }
                                  }
                              ]
                 }
             ],
    "variable":  [
                     {
                         "key":  "baseUrl",
                         "value":  "http://localhost:8080"
                     },
                     {
                         "key":  "authToken",
                         "value":  ""
                     },
                     {
                         "key":  "appointmentId",
                         "value":  ""
                     },
                     {
                         "key":  "eventId",
                         "value":  "1"
                     },
                     {
                         "key":  "currentUserId",
                         "value":  ""
                     }
                 ]
}
